<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>가위바위보 게임</title>
    <link rel="stylesheet" href="../../css/common.css" />
    <!-- <link rel="stylesheet" href="./css/style.css" /> -->
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 0;
            padding: 0;
            background-color: #f8f9fa;
        }

        .container {
            width: 90%;
            max-width: 600px;
            margin: 0 auto;
        }

        main {
            margin-top: 30px;
        }

        button {
            margin: 10px;
            padding: 12px 24px;
            font-size: 18px;
            border: none;
            border-radius: 8px;
            background-color: #4caf50;
            color: white;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
            /* 애니메이션 */
        }

        button:hover {
            background-color: #45a049;
            transform: scale(1.1);
            /* 버튼 애니메이션 */
        }

        #result,
        #score {
            margin-top: 20px;
            font-size: 20px;
        }

        @media (max-width: 600px) {
            button {
                width: 80%;
                max-width: 250px;
                margin: 10px auto;
                display: block;
                font-size: 20px;
            }
        }
    </style>

</head>

<body>
    <header>
        <div class="container">
            <h1>가위바위보 게임</h1>
            <a href="../../index.html" class="back-btn">뒤로</a>
        </div>
    </header>

    <main>
        <div>
            <button onclick="play('가위')">가위</button>
            <button onclick="play('바위')">바위</button>
            <button onclick="play('보')">보</button>
        </div>

        <div id="result"></div>
        <div id="score"></div>

        <div style="margin-top:20px;">
            <button onclick="resetGame()">다시 시작!</button>
        </div>
    </main>

    <footer>
        <div class="container">
            한 걸음씩, 꿈을 향해 🌟
        </div>
    </footer>

    <script>
        let wins = 0;
        let losses = 0;
        let draws = 0;
        let rounds = 0; // 총 몇 판 했는지

        let isPlaying = false; // 지금 게임 중인지 체크하는 변수 추가

        function setButtonsDisabled(disabled) {
            const buttons = document.querySelectorAll('main button');
            buttons.forEach(button => {
                button.disabled = disabled;
            });
        }


        function play(userChoice) {
            if (isPlaying) return; // 만약 진행 중이면 클릭 무시
            isPlaying = true; // 클릭하면 바로 진행 중으로 바꾸기
            setButtonsDisabled(true); // 버튼 비활성화

            const choices = ['가위', '바위', '보'];
            const computerChoice = choices[Math.floor(Math.random() * 3)];
            const randomComment = [
                '이번엔 잘했죠? 😉',
                '다음엔 이길게요! 😎',
                '어라? 실수했나...? 🙈',
                '승부는 언제나 예측불가! 🎲'
            ];

            let result = '';
            let comment = '';
            let emoji = '';

            if (userChoice === computerChoice) {
                result = '비겼습니다!';
                draws++;
                comment = '좋은 승부였어요! 🤝';
                emoji = '🤝';
            } else if (
                (userChoice === '가위' && computerChoice === '보') ||
                (userChoice === '바위' && computerChoice === '가위') ||
                (userChoice === '보' && computerChoice === '바위')
            ) {
                result = '이겼습니다!';
                wins++;
                comment = '대단해요! 🏆';
                emoji = '🏆';
            } else {
                result = '졌습니다!';
                losses++;
                comment = '아쉽네요... 다시 도전! 😭';
                emoji = '😭';
            }

            rounds++;

            // 가끔 랜덤 멘트 추가
            if (Math.random() < 0.3) { // 30% 확률
                comment += `<br><small>${randomComment[Math.floor(Math.random() * randomComment.length)]}</small>`;
            }

            // 승리/패배 추가
            if (wins === 3) {
                comment += `<br><strong>왕중왕! 🏅</strong>`;
            } else if (losses === 3) {
                comment += `<br><strong>다음엔 분발해요! 💪</strong>`;
            }

            document.getElementById('result').innerHTML = `
            <p>당신: ${userChoice}<br>컴퓨터: ${computerChoice}</p>
            <h2>${emoji} ${result}</h2>
            <p>${comment}</p>
          `;

            document.getElementById('score').innerHTML = `
            <p>🏆 승: ${wins} | 😭 패: ${losses} | 🤝 무: ${draws} | 🔢 ${rounds}판 진행</p>
          `;

            // 배경색 랜덤 변경
            const randomColor = `hsl(${Math.random() * 360}, 100%, 90%)`;
            document.body.style.backgroundColor = randomColor;

            // 5판 3선승제 체크
            if (rounds >= 5 || wins === 3 || losses === 3) {
                setTimeout(() => {
                    alert(`게임 종료!\n🏆 승: ${wins}\n😭 패: ${losses}\n🤝 무: ${draws}`);
                    resetGame();
                    isPlaying = false; // 게임 리셋 후 클릭 가능하게 변경
                    setButtonsDisabled(false); // 게임 리셋되면 다시 버튼 활성화
                }, 500);
            } else {
                // 게임이 안 끝났으면 바로 클릭 가능하게
                setTimeout(() => {
                    isPlaying = false;
                    setButtonsDisabled(false); // 게임 리셋되면 다시 버튼 활성화
                }, 500); // 약간의 시간 주기
            }
        }

        function resetGame() {
            wins = 0;
            losses = 0;
            draws = 0;
            rounds = 0;
            document.getElementById('result').innerHTML = '';
            document.getElementById('score').innerHTML = '';
            document.body.style.backgroundColor = '#f8f9fa'; // 초기 배경색
        }
    </script>
</body>

</html>