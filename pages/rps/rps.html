<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ê°€ìœ„ë°”ìœ„ë³´ ê²Œì„</title>
    <link rel="stylesheet" href="../../css/common.css" />
    <link rel="stylesheet" href="rps.css" />
</head>

<body>
    <header>
        <div class="container">
            <h1>ê°€ìœ„ë°”ìœ„ë³´ ê²Œì„</h1>
            <a href="../../index.html" class="back-btn">ë’¤ë¡œ</a>
        </div>
    </header>

    <main>
        <div class="game-container">
            <div class="choices">
                <button onclick="play('ê°€ìœ„')">ê°€ìœ„</button>
                <button onclick="play('ë°”ìœ„')">ë°”ìœ„</button>
                <button onclick="play('ë³´')">ë³´</button>
            </div>

            <div class="result-container">
                <div id="result"></div>
                <div id="score"></div>
            </div>

            <button id="resetButton" class="reset-btn">ë‹¤ì‹œ ì‹œì‘!</button>
        </div>
    </main>

    <footer>
        <div class="container">
            í•œ ê±¸ìŒì”©, ê¿ˆì„ í–¥í•´ ğŸŒŸ
        </div>
    </footer>

    <script>
        let wins = 0;
        let losses = 0;
        let draws = 0;
        let rounds = 0;
        let isPlaying = false;

        const randomComments = [
            'ì´ë²ˆì—” ì˜í–ˆì£ ? ğŸ˜‰',
            'ë‹¤ìŒì—” ì´ê¸¸ê²Œìš”! ğŸ˜',
            'ì–´ë¼? ì‹¤ìˆ˜í–ˆë‚˜...? ğŸ™ˆ',
            'ìŠ¹ë¶€ëŠ” ì–¸ì œë‚˜ ì˜ˆì¸¡ë¶ˆê°€! ğŸ²'
        ];

        function setButtonsDisabled(disabled) {
            const buttons = document.querySelectorAll('.choices button');
            buttons.forEach(button => {
                button.disabled = disabled;
            });
        }

        function play(userChoice) {
            if (isPlaying) return;
            isPlaying = true;
            setButtonsDisabled(true);

            const choices = ['ê°€ìœ„', 'ë°”ìœ„', 'ë³´'];
            const computerChoice = choices[Math.floor(Math.random() * 3)];

            let result = '';
            let comment = '';
            let emoji = '';

            if (userChoice === computerChoice) {
                result = 'ë¹„ê²¼ìŠµë‹ˆë‹¤!';
                draws++;
                comment = 'ì¢‹ì€ ìŠ¹ë¶€ì˜€ì–´ìš”! ğŸ¤';
                emoji = 'ğŸ¤';
            } else if (
                (userChoice === 'ê°€ìœ„' && computerChoice === 'ë³´') ||
                (userChoice === 'ë°”ìœ„' && computerChoice === 'ê°€ìœ„') ||
                (userChoice === 'ë³´' && computerChoice === 'ë°”ìœ„')
            ) {
                result = 'ì´ê²¼ìŠµë‹ˆë‹¤!';
                wins++;
                comment = 'ëŒ€ë‹¨í•´ìš”! ğŸ†';
                emoji = 'ğŸ†';
            } else {
                result = 'ì¡ŒìŠµë‹ˆë‹¤!';
                losses++;
                comment = 'ì•„ì‰½ë„¤ìš”... ë‹¤ì‹œ ë„ì „! ğŸ˜­';
                emoji = 'ğŸ˜­';
            }

            rounds++;

            if (Math.random() < 0.3) {
                comment += `<br><small>${randomComments[Math.floor(Math.random() * randomComments.length)]}</small>`;
            }

            if (wins === 3) {
                comment += `<br><strong>ì™•ì¤‘ì™•! ğŸ…</strong>`;
            } else if (losses === 3) {
                comment += `<br><strong>ë‹¤ìŒì—” ë¶„ë°œí•´ìš”! ğŸ’ª</strong>`;
            }

            document.getElementById('result').innerHTML = `
                <p>ë‹¹ì‹ : ${userChoice} <br> ì»´í“¨í„°: ${computerChoice}</p>
                <h2>${emoji} ${result}</h2>
                <p>${comment}</p>
            `;

            document.getElementById('score').innerHTML = `
                <p>ğŸ† ìŠ¹: ${wins} | ğŸ˜­ íŒ¨: ${losses} | ğŸ¤ ë¬´: ${draws} | ğŸ”¢ ${rounds}íŒ ì§„í–‰</p>
            `;

            const randomColor = `hsl(${Math.random() * 360}, 100%, 90%)`;
            document.body.style.backgroundColor = randomColor;

            if (rounds >= 5 || wins === 3 || losses === 3) {
                showGameEnd();
            } else {
                setTimeout(() => {
                    isPlaying = false;
                    setButtonsDisabled(false);
                }, 500);
            }
        }

        function showGameEnd() {
            document.getElementById('result').innerHTML += `
                <div class="game-end">
                    <h2>ğŸ‰ ê²Œì„ ì¢…ë£Œ! ğŸ‰</h2>
                    <p>ğŸ† ìŠ¹: ${wins} | ğŸ˜­ íŒ¨: ${losses} | ğŸ¤ ë¬´: ${draws}</p>
                </div>
            `;
            document.getElementById('score').style.display = 'none';
            document.getElementById('resetButton').style.display = 'block';
            setButtonsDisabled(true);
            isPlaying = false;
        }

        function resetGame() {
            wins = 0;
            losses = 0;
            draws = 0;
            rounds = 0;
            document.getElementById('result').innerHTML = '';
            document.getElementById('score').innerHTML = '';
            document.getElementById('score').style.display = 'block';
            document.body.style.backgroundColor = '#f8f9fa';
            document.getElementById('resetButton').style.display = 'none';
            setButtonsDisabled(false);
            isPlaying = false;
        }

        document.getElementById('resetButton').addEventListener('click', resetGame);
    </script>
</body>

</html>